nohup: ignoring input
2021-07-17 14:02:28.079017: W tensorflow/stream_executor/platform/default/dso_loader.cc:64] Could not load dynamic library 'libcudart.so.11.0'; dlerror: libcudart.so.11.0: cannot open shared object file: No such file or directory; LD_LIBRARY_PATH: :/home/micrl/.mujoco/mjpro150/bin:/usr/local/cuda-10.1/lib64:/usr/local/cuda-10.0/lib64:/home/micrl/.mujoco/mjpro150/bin:/usr/local/cuda-10.1/lib64:/usr/local/cuda-10.0/lib64
2021-07-17 14:02:28.079047: I tensorflow/stream_executor/cuda/cudart_stub.cc:29] Ignore above cudart dlerror if you do not have a GPU set up on your machine.
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11111] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11113] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11115] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11117] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11119] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11121] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11123] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11125] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@100] [$11127] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:46.315 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$32871] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$32873] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$32875] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$33405] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$33407] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@100] [$33409] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:02:50.502 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85167] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85169] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85171] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 93, in collide
    dist = self.sdf(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 59, in sdf
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85701] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85703] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@100] [$85705] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.424 14394] [type_check.cpp:visit@101] 
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 198, in grid_op
    v_out = self.primitives[i].collide(f, I * self.dx, v_out, self.dt)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 96, in collide
    D = self.normal(f, grid_pos)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 50, in decorated
    return fun.__call__(*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 122, in __call__
    ret = self.compiled(*args)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/primitive/primive_base.py", line 79, in normal
    grid_pos = inv_trans(grid_pos, self.position[f], self.rotation[f])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/util.py", line 163, in wrapped
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/impl.py", line 201, in maybe_transform_ti_func_call_to_stmt
    return func(*args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/common_ops.py", line 227, in assign
    return ti.assign(self, other)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/ops.py", line 130, in wrapped
    return a.element_wise_writeback_binary(imp_foo, b)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/matrix.py", line 179, in element_wise_writeback_binary
    ret.entries[i] = foo(self.entries[i], other.entries[i])

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$89319] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$89337] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$89463] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$89487] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$89575] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90346] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90371] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90458] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90812] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90827] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@100] [$90842] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:12.796 14394] [type_check.cpp:visit@101] 

[W 07/17/21 14:03:26.002 14394] [type_check.cpp:visit@100] [$131560] Local store may lose precision (target = f32, value = f64) at
[W 07/17/21 14:03:26.003 14394] [type_check.cpp:visit@101] 

[E 07/17/21 14:07:21.632 14394] [cuda_driver.h:operator()@81] CUDA Error CUDA_ERROR_OUT_OF_MEMORY: out of memory while calling malloc (cuMemAlloc_v2)


[38;2;255;000;255m***********************************
[0m[38;2;255;000;255m* Taichi Compiler Stack Traceback *
[0m[38;2;255;000;255m***********************************
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so: taichi::Logger::error(std::__cxx11::basic_string<char, std::char_traits<char>, std::allocator<char> > const&, bool)
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so: taichi::lang::CUDADriverFunction<void**, unsigned long>::operator()(void**, unsigned long)
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so: taichi::lang::CodeGenLLVMCUDA::compile_module_to_executable()::{lambda(taichi::lang::Context&)#1}::operator()(taichi::lang::Context&) const
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so: taichi::lang::Kernel::operator()(taichi::lang::Kernel::LaunchContextBuilder&)
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so(+0x35b04a) [0x7fe40158704a]
[0m[38;2;255;000;255m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/core/../lib/taichi_core.so(+0x34476a) [0x7fe40157076a]
[0m[38;2;255;000;255mpython(PyCFunction_Call+0x54) [0x558d70380834]
[0m[38;2;255;000;255mpython(_PyObject_MakeTpCall+0x158) [0x558d70341da8]
[0m[38;2;255;000;255mpython(+0x1a3747) [0x558d70379747]
[0m[38;2;255;000;255mpython(PyVectorcall_Call+0x6e) [0x558d70342ede]
[0m[38;2;255;000;255mpython(+0xb8557) [0x558d7028e557]
[0m[38;2;255;000;255mpython(_PyObject_MakeTpCall+0x158) [0x558d70341da8]
[0m[38;2;255;000;255mpython(_PyEval_EvalFrameDefault+0x3c3) [0x558d7039c673]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x952) [0x558d7036e132]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x19b) [0x558d7036e7fb]
[0m[38;2;255;000;255mpython(PyVectorcall_Call+0x6e) [0x558d70342ede]
[0m[38;2;255;000;255mpython(_PyEval_EvalFrameDefault+0x4e70) [0x558d703a1120]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x1e9) [0x558d7036d9c9]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x19b) [0x558d7036e7fb]
[0m[38;2;255;000;255mpython(_PyObject_FastCallDict+0xd2) [0x558d70359242]
[0m[38;2;255;000;255mpython(+0xb84c2) [0x558d7028e4c2]
[0m[38;2;255;000;255mpython(+0x1f0aa8) [0x558d703c6aa8]
[0m[38;2;255;000;255mpython(PyObject_Call+0x61) [0x558d70343061]
[0m[38;2;255;000;255mpython(_PyEval_EvalFrameDefault+0x4e70) [0x558d703a1120]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x1e9) [0x558d7036d9c9]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x19b) [0x558d7036e7fb]
[0m[38;2;255;000;255mpython(_PyObject_FastCallDict+0x56) [0x558d703591c6]
[0m[38;2;255;000;255mpython(+0xb84c2) [0x558d7028e4c2]
[0m[38;2;255;000;255mpython(+0x1f0aa8) [0x558d703c6aa8]
[0m[38;2;255;000;255mpython(PyObject_Call+0x61) [0x558d70343061]
[0m[38;2;255;000;255mpython(_PyEval_EvalFrameDefault+0x4e70) [0x558d703a1120]
[0m[38;2;255;000;255mpython(+0x1a3376) [0x558d70379376]
[0m[38;2;255;000;255mpython(+0x146149) [0x558d7031c149]
[0m[38;2;255;000;255mpython(+0x1a3376) [0x558d70379376]
[0m[38;2;255;000;255mpython(+0x146149) [0x558d7031c149]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x952) [0x558d7036e132]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x19b) [0x558d7036e7fb]
[0m[38;2;255;000;255mpython(+0x145e14) [0x558d7031be14]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x952) [0x558d7036e132]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x19b) [0x558d7036e7fb]
[0m[38;2;255;000;255mpython(+0x146254) [0x558d7031c254]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x108) [0x558d7036e768]
[0m[38;2;255;000;255mpython(+0x145e14) [0x558d7031be14]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x108) [0x558d7036e768]
[0m[38;2;255;000;255mpython(+0x145e14) [0x558d7031be14]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x1e9) [0x558d7036d9c9]
[0m[38;2;255;000;255mpython(+0x1e1e8f) [0x558d703b7e8f]
[0m[38;2;255;000;255mpython(+0x16f61d) [0x558d7034561d]
[0m[38;2;255;000;255mpython(+0x145e14) [0x558d7031be14]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x886) [0x558d7036e066]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x1ff) [0x558d7036e85f]
[0m[38;2;255;000;255mpython(+0x145e14) [0x558d7031be14]
[0m[38;2;255;000;255mpython(_PyEval_EvalCodeWithName+0x1e9) [0x558d7036d9c9]
[0m[38;2;255;000;255mpython(_PyFunction_Vectorcall+0x1ff) [0x558d7036e85f]
[0m[38;2;255;000;255mpython(PyVectorcall_Call+0x6e) [0x558d70342ede]
[0m[38;2;255;000;255mpython(+0x207fca) [0x558d703ddfca]
[0m[38;2;255;000;255mpython(Py_RunMain+0x13c) [0x558d703df84c]
[0m[38;2;255;000;255mpython(Py_BytesMain+0x39) [0x558d703dfca9]
[0m[38;2;255;000;255m/lib/x86_64-linux-gnu/libc.so.6: __libc_start_main
[0m[38;2;255;000;255mpython(+0x1e21c7) [0x558d703b81c7]
[0m[38;2;255;165;000m
Internal error occurred. Check out this page for possible solutions:
https://taichi.readthedocs.io/en/stable/install.html#troubleshooting
[0m/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/gym/logger.py:30: UserWarning: [33mWARN: Box bound precision lowered by casting to float32[0m
  warnings.warn(colorize('%s: %s'%('WARN', msg % args), 'yellow'))
Traceback (most recent call last):
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/runpy.py", line 194, in _run_module_as_main
    return _run_code(code, main_globals, None,
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/runpy.py", line 87, in _run_code
    exec(code, run_globals)
  File "/home/micrl/chensirui/PlasticineLab/plb/algorithms/solve.py", line 91, in <module>
    main()
  File "/home/micrl/chensirui/PlasticineLab/plb/algorithms/solve.py", line 86, in main
    learn_latent(env, args.path, args)
  File "/home/micrl/chensirui/PlasticineLab/plb/optimizer/learn_latent.py", line 139, in learn_latent
    current_loss = solver.solve(state,action,target,grad_buffer,state_buffer)
  File "/home/micrl/chensirui/PlasticineLab/plb/optimizer/learn_latent.py", line 56, in solve
    loss, (x_hat_grad,v_hat_grad) = forward(state_hat,target,action)
  File "/home/micrl/chensirui/PlasticineLab/plb/optimizer/learn_latent.py", line 34, in forward
    env.set_state(state, self.cfg.softness, False)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/taichi_env.py", line 120, in set_state
    self.simulator.set_state(0, state)
  File "/home/micrl/chensirui/PlasticineLab/plb/engine/mpm_simulator.py", line 347, in set_state
    self.setframe(f, *state[:4])
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 668, in __call__
    return self._primal(self._kernel_owner, *args, **kwargs)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 563, in __call__
    return self.compiled_functions[key](*args)
  File "/home/micrl/anaconda2/envs/taichi/lib/python3.8/site-packages/taichi/lang/kernel_impl.py", line 517, in func__
    t_kernel(launch_ctx)
RuntimeError: [cuda_driver.h:operator()@81] CUDA Error CUDA_ERROR_OUT_OF_MEMORY: out of memory while calling malloc (cuMemAlloc_v2)
[Taichi] mode=release
[Taichi] preparing sandbox at /tmp/taichi-o0qjt5k_
[Taichi] version 0.7.23, llvm 10.0.0, commit 0b89df86, linux, python 3.8.10
Loaded compiled 3D CUDA chamfer distance
[Taichi] Starting on arch=cuda
Building primitive
action:
  dim: 7
  scale: (0.02, 0.02, 0.02, 0.04, 0.04, 0.04, 0.02)
color: (0.8, 0.8, 0.8)
friction: 10.0
h: 0.2
init_gap: 0.06
init_pos: (0.5, 0.15, 0.5)
init_rot: (1.0, 0.0, 0.0, 0.0)
lower_bound: (0.0, 0.0, 0.0)
minimal_gap: 0.06
r: 0.02
shape: Chopsticks
upper_bound: (1.0, 1.0, 1.0)
variations: None
{'width': (0.04, 0.04, 0.6), 'init_pos': (0.5, 0.02, 0.5), 'color': 100, 'n_particles': 8192}
Number of particles:  8192
Initialize Renderer
bake_size: 6  
camera_pos: (0.5, 1.2, 4.0)  
camera_rot: (0.2, 0)  
dx: 0.006666666666666667  
image_res: (512, 512)  
light_direction: (2.0, 1.0, 0.7)  
max_num_particles: 1000000  
max_ray_depth: 2  
sdf_threshold: 0.20720000000000002  
spp: 50  
target_res: (64, 64, 64)  
use_directional_light: True  
use_roulette: False  
voxel_res: (168, 168, 168)
[Taichi] materializing...
TaichiEnv Number of Particles: 8192
Batch: 1 Loss:  0.03631239750732978
